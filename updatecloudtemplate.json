{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Resources": {
      "LF2": {
          "Type": "AWS::Lambda::Function",
          "Properties" : {
                "Code": {
                    "S3Bucket": "assignment2-lambdas",
                    "S3Key": "LF2-search-photos.zip"
                },
                "Description" : "Function for searching for indexed photos",
                "Environment" : {
                    "Variables" : {"Region" : "us-east-1"}
                      },
                "FunctionName" : "search-photos",
                "Handler" : "lambda_function.lambda_handler",
                "MemorySize" : 128,
                "Role":"arn:aws:iam::395718007070:role/service-role/search-photos-role-hw74j5wv",
                "Runtime" : "python3.8",
                "Timeout" : 15
              },
          "Metadata": {
              "AWS::CloudFormation::Designer": {
                  "id": "224683be-6ecc-489e-b989-acffeeb4f3db"
              }
          }
      },
      "LF1": {
          "Type": "AWS::Lambda::Function",
          "Properties": {
              "Code":{
                  "S3Bucket": "assignment2-lambdas",
                  "S3Key": "LF1-index-photos.zip"
              },
              "Description" : "Function for indexing photos",
              "Environment" : {
                    "Variables" : {"Region" : "us-east-1"}
                      },
              "FunctionName": "index-photos",
              "Handler": "lambda_function.lambda_handler",
              "MemorySize": 128,
              "Runtime": "python3.9",
              "Timeout": 15,
              "Role": "arn:aws:iam::395718007070:role/service-role/rekognition"
          },
          "Metadata": {
              "AWS::CloudFormation::Designer": {
                  "id": "376bd623-7828-4e23-81fa-536a5584e39c"
              }
          }
      },
      "OpenSearchAlbum": {
          "Type": "AWS::OpenSearchService::Domain",
          "Properties": {
              "AccessPolicies": {
                  "Version": "2012-10-17",
                  "Statement": [
                      {
                          "Effect": "Allow",
                          "Principal": {
                              "AWS": "*"
                          },
                          "Action": [
                              "es:*"
                          ],
                          "Resource": "arn:aws:es:us-east-1:395718007070:domain/photos/*"
                      }
                  ]
              },
              "DomainName": "photos",
              "ClusterConfig": {
                  "DedicatedMasterEnabled": false,
                  "InstanceCount": 1,
                  "InstanceType": "t3.small.search"
              },
              "EBSOptions":{
                  "EBSEnabled": true,
                  "Iops": 0,
                  "VolumeSize": 10,
                  "VolumeType": "gp2"
              }
          },
          "Metadata": {
              "AWS::CloudFormation::Designer": {
                  "id": "1e860488-d551-4915-8fc8-17d920946d7f"
              }
          }
      },
      "PhotoAlbumS3B2": {
          "Type": "AWS::S3::Bucket",
          "Properties": {
              "BucketName": "assignment2-kerem-nana-photos"
          },
          "DeletionPolicy": "Retain"
      }
  }
}
