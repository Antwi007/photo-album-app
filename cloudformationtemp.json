{
    "AWSTemplateFormatVersion": "2010-09-09",
    "Description": "An AWS Serverless Specification",
    "Resources": {
      "PhotoAlbumS3B2": {
        "Type": "AWS::S3::Bucket",
        "Properties": {
          "BucketName": "assignment2-kerem-nana-photos"
        },
        "DeletionPolicy": "Retain"
      },
      "LF1": {
        "Type": "AWS::Lambda::Function",
        "Properties": {
          "Code": {
            "S3Bucket": "photo-album-lambdas",
            "S3Key": "6ca4f94ea8b51bf4101af65b91627931"
          },
          "Description": "",
          "Handler": "lambda_function.lambda_handler",
          "MemorySize": 128,
          "Role": "arn:aws:iam::395718007070:role/service-role/rekognition",
          "Runtime": "python3.9",
          "Timeout": 15,
          "Tags": [
            {
              "Key": "lambda:createdBy",
              "Value": "SAM"
            }
          ]
        }
      },
      "OpenSearchAlbumOS1": {
        "Type": "AWS::OpenSearchService::Domain",
        "DeletionPolicy":"Retain",
        "Properties": {
            "AccessPolicies": {
                "Version": "2012-10-17",
                "Statement": [
                    {
                        "Effect": "Allow",
                        "Principal": {
                            "AWS": "*"
                        },
                        "Action": [
                            "es:*"
                        ],
                        "Resource": "arn:aws:es:us-east-1:395718007070:domain/photos/*"
                    }
                ]
            },
            "NodeToNodeEncryptionOptions": {
                "Enabled": true
            },
            "DomainEndpointOptions" : {
              "EnforceHTTPS" : true
            },
            "AdvancedSecurityOptions": {
                "Enabled": true,
                "InternalUserDatabaseEnabled": true,
                "MasterUserOptions": {
                    "MasterUserName": "KeremNana",
                    "MasterUserPassword": "KeremNana1!"
                }
            },
            "EncryptionAtRestOptions": {
                "Enabled": true,
                "KmsKeyId": "arn:aws:kms:us-east-1:395718007070:key/79cb5455-3856-4910-aaf9-855a231c5458"
            },
            "DomainName": "photos",
            "ClusterConfig": {
                "DedicatedMasterEnabled": false,
                "InstanceCount": 1,
                "InstanceType": "t3.small.search"
            },
            "EBSOptions":{
                "EBSEnabled": true,
                "Iops": 0,
                "VolumeSize": 10,
                "VolumeType": "gp2"
            }
        }
    },
      "LF2": {
        "Type": "AWS::Lambda::Function",
        "Properties": {
          "Code": {
            "S3Bucket": "photo-album-lambdas",
            "S3Key": "8d9d20ef6c8eca60cd4f13b1d4786773"
          },
          "Description": "Function for searching for indexed photos",
          "Handler": "lambda_function.lambda_handler",
          "MemorySize": 128,
          "Role": "arn:aws:iam::395718007070:role/service-role/search-photos-role-hw74j5wv",
          "Runtime": "python3.8",
          "Timeout": 15,
          "Environment": {
            "Variables": {
              "Region": "us-east-1"
            }
          },
          "Tags": [
            {
              "Key": "lambda:createdBy",
              "Value": "SAM"
            }
          ]
        }
      }
    }
  }
  